<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Road Trip Adventure - Bydgoszcz to Italy 2025</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Leaflet core -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <!-- jsPDF (no SRI for compatibility) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    .map-container { height: 400px; width: 100%; }
    .trip-day:hover .day-number { transform: scale(1.1); background-color: #3b82f6; }
    .parallax { background-attachment: fixed; background-position: center; background-repeat: no-repeat; background-size: cover; }
    @media (max-width: 768px) { .parallax { background-attachment: scroll; } }
    /* Leaflet tweaks */
    .leaflet-container { font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .leaflet-div-icon { background: transparent; border: none; }
    .marker-dot { width: 30px; height: 30px; border-radius: 9999px; display:flex; align-items:center; justify-content:center; font-weight:700; color:white; box-shadow:0 6px 16px rgba(0,0,0,.2); }
    .marker-day { background:#3b82f6; }
    .marker-stop { background:#10b981; }
    .timeline-hidden { display:none; }
    /* Sticky mini map */
    #miniMap { position: fixed; bottom: 16px; right: 16px; width: 260px; height: 180px; z-index: 60; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,.25); }
    #miniMap .leaflet-control-attribution { display:none; }
    @media (max-width: 1024px){ #miniMap { display:none; } }
    .photo-strip { display:flex; gap:8px; overflow-x:auto; padding-top:8px; }
    .photo-strip img { height:84px; width:auto; border-radius:10px; object-fit:cover; flex:0 0 auto; }
    .comment-card { background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:16px; box-shadow:0 4px 10px rgba(0,0,0,.04); }
  </style>
</head>
<body class="font-sans bg-gray-50">
  <!-- Navigation -->
  <nav class="bg-blue-600 text-white sticky top-0 z-50 shadow-lg">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center space-x-2"><i class="fas fa-route text-2xl"></i><span class="text-xl font-bold">Road Trip 2025</span></div>
      <div class="hidden md:flex space-x-6">
        <a href="#overview" class="hover:text-blue-200 transition">Overview</a>
        <a href="#itinerary" class="hover:text-blue-200 transition">Itinerary</a>
        <a href="#accommodation" class="hover:text-blue-200 transition">Accommodation</a>
        <a href="#budget" class="hover:text-blue-200 transition">Budget</a>
        <a href="#tips" class="hover:text-blue-200 transition">Tips</a>
      </div>
      <button class="md:hidden text-2xl" id="menuBtn"><i class="fas fa-bars"></i></button>
    </div>
    <div class="md:hidden hidden bg-blue-700 py-2" id="mobileMenu">
      <div class="container mx-auto px-4 flex flex-col space-y-3">
        <a href="#overview" class="hover:text-blue-200 transition">Overview</a>
        <a href="#itinerary" class="hover:text-blue-200 transition">Itinerary</a>
        <a href="#accommodation" class="hover:text-blue-200 transition">Accommodation</a>
        <a href="#budget" class="hover:text-blue-200 transition">Budget</a>
        <a href="#tips" class="hover:text-blue-200 transition">Tips</a>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <header class="relative h-screen flex items-center justify-center text-white overflow-hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="parallax bg-[url('https://images.unsplash.com/photo-1503917988258-f87a78e3c995?auto=format&fit=crop&w=2070&q=80')] bg-center bg-cover w-full h-full"></div>
    <div class="relative z-10 text-center px-4">
      <h1 class="text-4xl md:text-6xl font-bold mb-4">European Road Trip</h1>
      <p class="text-xl md:text-2xl mb-8">Bydgoszcz to Italy • 11-21 September 2025</p>
      <div class="flex flex-wrap justify-center gap-4">
        <a href="#itinerary" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition transform hover:scale-105">View Itinerary</a>
        <a href="#budget" class="bg-white hover:bg-gray-100 text-blue-600 px-6 py-3 rounded-lg font-medium transition transform hover:scale-105">Budget Details</a>
      </div>
    </div>
  </header>

  <!-- Overview -->
  <section id="overview" class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-gray-800">Trip Overview</h2>
      <div class="grid md:grid-cols-3 gap-8">
        <div class="bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition">
          <div class="text-blue-600 text-4xl mb-4"><i class="fas fa-route"></i></div>
          <h3 class="text-xl font-semibold mb-2 text-gray-800">Route</h3>
          <p class="text-gray-600">Bydgoszcz → Vienna → Lake Garda → Florence → Pisa → Venice → Bydgoszcz</p>
          <p class="mt-4 text-gray-500"><i class="fas fa-road mr-2"></i>Total distance: ~3,500 km</p>
        </div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition">
          <div class="text-blue-600 text-4xl mb-4"><i class="fas fa-calendar-alt"></i></div>
          <h3 class="text-xl font-semibold mb-2 text-gray-800">Dates</h3>
          <p class="text-gray-600">11-21 September 2025</p>
          <p class="mt-4 text-gray-500"><i class="fas fa-moon mr-2"></i>11 days / 10 nights</p>
        </div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition">
          <div class="text-blue-600 text-4xl mb-4"><i class="fas fa-users"></i></div>
          <h3 class="text-xl font-semibold mb-2 text-gray-800">Travelers</h3>
          <p class="text-gray-600">4 friends by car</p>
          <p class="mt-4 text-gray-500"><i class="fas fa-car mr-2"></i>1 vehicle</p>
        </div>
      </div>
      <div class="mt-16 bg-gray-100 rounded-xl overflow-hidden shadow-lg">
        <div class="p-4 bg-blue-600 text-white"><h3 class="text-xl font-semibold"><i class="fas fa-map-marked-alt mr-2"></i>Trip Map</h3></div>
        <div class="map-container" id="map"><div class="h-full flex items-center justify-center bg-gray-200"><p class="text-gray-500">Interactive map loading...</p></div></div>
      </div>
    </div>
  </section>

  <!-- Itinerary -->
  <section id="itinerary" class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-gray-800">Day-by-Day Itinerary</h2>
      <div class="relative">
        <div class="hidden md:block absolute left-1/2 h-full w-1 bg-blue-400 transform -translate-x-1/2"></div>
        <div id="timeline" class="space-y-8">
          <!-- Days 1–5 -->
          <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="1">
            <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">1</div>
            <div class="md:ml-8 w-full">
              <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="text-xl font-semibold text-gray-800">Bydgoszcz → Vienna</h3>
                    <p class="text-gray-500">Thursday, 11 September 2025</p>
                  </div>
                  <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full">Travel Day</span>
                </div>
                <div class="mt-4 text-gray-600">
                  <p><i class="fas fa-clock mr-2 text-blue-500"></i>~8-9 hours drive</p>
                  <p><i class="fas fa-map-marker-alt mr-2 text-blue-500"></i>Evening walk in the city center</p>
                  <p><i class="fas fa-bed mr-2 text-blue-500"></i>Overnight: Vienna</p>
                </div>
              </div>
            </div>
          </div>
          <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="2">
            <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">2</div>
            <div class="md:ml-8 w-full">
              <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="text-xl font-semibold text-gray-800">Vienna Exploration</h3>
                    <p class="text-gray-500">Friday, 12 September 2025</p>
                  </div>
                  <span class="bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full">City Tour</span>
                </div>
                <div class="mt-4 text-gray-600">
                  <p><i class="fas fa-umbrella-beach mr-2 text-blue-500"></i>Full day of sightseeing in Vienna</p>
                  <p><i class="fas fa-car mr-2 text-blue-500"></i>Afternoon drive to Klagenfurt/Villach (~2-3 hours)</p>
                  <p><i class="fas fa-bed mr-2 text-blue-500"></i>Overnight: Klagenfurt/Villach</p>
                </div>
              </div>
            </div>
          </div>
          <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="3">
            <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">3</div>
            <div class="md:ml-8 w-full">
              <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="text-xl font-semibold text-gray-800">Klagenfurt → Lake Garda</h3>
                    <p class="text-gray-500">Saturday, 13 September 2025</p>
                  </div>
                  <span class="bg-yellow-100 text-yellow-800 text-sm px-3 py-1 rounded-full">Scenic Drive</span>
                </div>
                <div class="mt-4 text-gray-600">
                  <p><i class="fas fa-clock mr-2 text-blue-500"></i>~5.5-6 hours drive</p>
                  <p><i class="fas fa-water mr-2 text-blue-500"></i>Evening by the lake (Sirmione/Desenzano)</p>
                  <p><i class="fas fa-bed mr-2 text-blue-500"></i>Overnight: Garda</p>
                </div>
              </div>
            </div>
          </div>
          <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="4">
            <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">4</div>
            <div class="md:ml-8 w-full">
              <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="text-xl font-semibold text-gray-800">Lake Garda Day</h3>
                    <p class="text-gray-500">Sunday, 14 September 2025</p>
                  </div>
                  <span class="bg-purple-100 text-purple-800 text-sm px-3 py-1 rounded-full">Nature Day</span>
                </div>
                <div class="mt-4 text-gray-600">
                  <p><i class="fas fa-ship mr-2 text-blue-500"></i>Boat trips on the lake</p>
                  <p><i class="fas fa-mountain mr-2 text-blue-500"></i>Visit Monte Baldo</p>
                  <p><i class="fas fa-city mr-2 text-blue-500"></i>Evening in Verona</p>
                  <p><i class="fas fa-bed mr-2 text-blue-500"></i>Overnight: Garda</p>
                </div>
              </div>
            </div>
          </div>
          <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="5">
            <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">5</div>
            <div class="md:ml-8 w-full">
              <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="text-xl font-semibold text-gray-800">Lake Garda → Florence</h3>
                    <p class="text-gray-500">Monday, 15 September 2025</p>
                  </div>
                  <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full">Travel Day</span>
                </div>
                <div class="mt-4 text-gray-600">
                  <p><i class="fas fa-sun mr-2 text-blue-500"></i>Morning by the lake</p>
                  <p><i class="fas fa-clock mr-2 text-blue-500"></i>~3.5 hours drive to Florence</p>
                  <p><i class="fas fa-utensils mr-2 text-blue-500"></i>Possible stop in Bologna</p>
                  <p><i class="fas fa-bed mr-2 text-blue-500"></i>Overnight: Florence</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Hidden extra days 6–11 -->
          <div id="extraDays" class="timeline-hidden">
            <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="6">
              <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">6</div>
              <div class="md:ml-8 w-full">
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                  <div class="flex justify-between items-start">
                    <div>
                      <h3 class="text-xl font-semibold text-gray-800">Florence Exploration</h3>
                      <p class="text-gray-500">Tuesday, 16 September 2025</p>
                    </div>
                    <span class="bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full">City Tour</span>
                  </div>
                  <p class="mt-4 text-gray-600"><i class="fas fa-landmark mr-2 text-blue-500"></i>Uffizi, Duomo, Ponte Vecchio</p>
                </div>
              </div>
            </div>
            <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="7">
              <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">7</div>
              <div class="md:ml-8 w-full">
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                  <div class="flex justify-between items-start">
                    <div>
                      <h3 class="text-xl font-semibold text-gray-800">Florence → Pisa (half day) → Florence</h3>
                      <p class="text-gray-500">Wednesday, 17 September 2025</p>
                    </div>
                    <span class="bg-yellow-100 text-yellow-800 text-sm px-3 py-1 rounded-full">Excursion</span>
                  </div>
                  <p class="mt-4 text-gray-600"><i class="fas fa-tower-observation mr-2 text-blue-500"></i>Piazza dei Miracoli</p>
                </div>
              </div>
            </div>
            <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="8">
              <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">8</div>
              <div class="md:ml-8 w-full">
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                  <div class="flex justify-between items-start">
                    <div>
                      <h3 class="text-xl font-semibold text-gray-800">Florence → Venice</h3>
                      <p class="text-gray-500">Thursday, 18 September 2025</p>
                    </div>
                    <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full">Travel Day</span>
                  </div>
                  <p class="mt-4 text-gray-600"><i class="fas fa-train-subway mr-2 text-blue-500"></i>Park in Mestre / Tronchetto</p>
                </div>
              </div>
            </div>
            <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="9">
              <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">9</div>
              <div class="md:ml-8 w-full">
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                  <div class="flex justify-between items-start">
                    <div>
                      <h3 class="text-xl font-semibold text-gray-800">Venice Day</h3>
                      <p class="text-gray-500">Friday, 19 September 2025</p>
                    </div>
                    <span class="bg-purple-100 text-purple-800 text-sm px-3 py-1 rounded-full">City Tour</span>
                  </div>
                  <p class="mt-4 text-gray-600"><i class="fas fa-ship mr-2 text-blue-500"></i>Vaporetto, Piazza San Marco, Rialto</p>
                </div>
              </div>
            </div>
            <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="10">
              <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">10</div>
              <div class="md:ml-8 w-full">
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                  <div class="flex justify-between items-start">
                    <div>
                      <h3 class="text-xl font-semibold text-gray-800">Venice → Vienna area</h3>
                      <p class="text-gray-500">Saturday, 20 September 2025</p>
                    </div>
                    <span class="bg-yellow-100 text-yellow-800 text-sm px-3 py-1 rounded-full">Return Drive</span>
                  </div>
                  <p class="mt-4 text-gray-600"><i class="fas fa-road mr-2 text-blue-500"></i>~6 hours to Austria</p>
                </div>
              </div>
            </div>
            <div class="trip-day relative flex flex-col md:flex-row items-center" data-day="11">
              <div class="day-number w-16 h-16 bg-blue-500 text-white rounded-full flex items-center justify-center text-xl font-bold mb-4 md:mb-0">11</div>
              <div class="md:ml-8 w-full">
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition">
                  <div class="flex justify-between items-start">
                    <div>
                      <h3 class="text-xl font-semibold text-gray-800">Austria → Bydgoszcz</h3>
                      <p class="text-gray-500">Sunday, 21 September 2025</p>
                    </div>
                    <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full">Return Drive</span>
                  </div>
                  <p class="mt-4 text-gray-600"><i class="fas fa-house mr-2 text-blue-500"></i>Home sweet home</p>
                </div>
              </div>
            </div>
          </div>

          <div class="text-center mt-8">
            <button id="showMoreDays" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition transform hover:scale-105">Show Full Itinerary</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Sticky mini map container -->
  <div id="miniMap" class="bg-white rounded-xl shadow-lg"></div>

  <!-- Weather floating box -->
  <div id="weatherBox" class="hidden fixed bottom-16 right-[292px] w-[280px] bg-white/95 backdrop-blur rounded-xl shadow-lg z-50 border border-gray-200">
    <div class="px-4 py-3 border-b bg-blue-600 text-white rounded-t-xl flex items-center justify-between">
      <div class="font-semibold"><i class="fas fa-cloud-sun mr-2"></i><span id="weatherTitle">Weather</span></div>
      <button id="closeWeather" class="text-white/80 hover:text-white"><i class="fas fa-times"></i></button>
    </div>
    <div class="p-3 text-sm" id="weatherContent">Select a day to see a 7‑day forecast for that stop.</div>
  </div>

  <!-- Accommodation -->
  <section id="accommodation" class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-gray-800">Accommodation & Parking</h2>
      <div class="grid md:grid-cols-2 gap-8">
        <div>
          <h3 class="text-2xl font-semibold mb-6 text-gray-800 flex items-center"><i class="fas fa-hotel mr-3 text-blue-500"></i>Accommodation Suggestions</h3>
          <div class="space-y-4">
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Vienna</h4><p class="text-gray-600 text-sm">Central hotel with garage (e.g. Motel One Wien-Staatsoper) or cheaper options near P+R Erdberg</p></div>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Klagenfurt/Villach</h4><p class="text-gray-600 text-sm">Hotels near A2 highway for easy morning departure</p></div>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Lake Garda</h4><p class="text-gray-600 text-sm">Apartments with parking in Desenzano or Sirmione</p></div>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Florence</h4><p class="text-gray-600 text-sm">Accommodation near T1 tram (Villa Costanza P+R) or in center with ZTL access</p></div>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Venice</h4><p class="text-gray-600 text-sm">Mestre (e.g. Hotel Plaza) - cheaper with good island access, or hotels on Tronchetto/island</p></div>
          </div>
        </div>
        <div>
          <h3 class="text-2xl font-semibold mb-6 text-gray-800 flex items-center"><i class="fas fa-parking mr-3 text-blue-500"></i>Parking Information</h3>
          <div class="space-y-4">
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Vienna</h4><p class="text-gray-600 text-sm">P+R Erdberg (Schlachthausgasse 2, 1030 Wien) + U3 metro</p></div>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Florence</h4><p class="text-gray-600 text-sm">Villa Costanza P+R (T1 tram to center ~22 min)</p></div>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Pisa</h4><p class="text-gray-600 text-sm">Via Cammeo Carlo Salomone (~€2.5/hour)</p></div>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm"><h4 class="font-medium text-gray-800">Venice</h4><p class="text-gray-600 text-sm">Tronchetto (~€29/24h) or Mestre Park Costa (~€5-14/day)</p></div>
          </div>
          <div class="mt-8 bg-blue-50 p-4 rounded-lg border border-blue-100">
            <h4 class="font-medium text-gray-800 flex items-center"><i class="fas fa-exclamation-triangle mr-2 text-yellow-500"></i>Important Note</h4>
            <p class="text-gray-600 text-sm mt-2">Avoid entering ZTL (limited traffic zones) in Florence and Pisa without proper authorization to avoid fines.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Budget -->
  <section id="budget" class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-gray-800">Estimated Budget</h2>
      <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-md overflow-hidden">
        <div class="p-6">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="border-b pb-4"><h3 class="text-lg font-semibold text-gray-800 mb-2">Fuel Costs</h3><div class="space-y-2"><div class="flex justify-between"><span class="text-gray-600">Total distance:</span><span class="font-medium">~3,500 km</span></div><div class="flex justify-between"><span class="text-gray-600">Fuel consumption:</span><span class="font-medium">9 l/100 km → 315 l</span></div><div class="flex justify-between"><span class="text-gray-600">Fuel price:</span><span class="font-medium">7.20 PLN/l</span></div><div class="flex justify-between pt-2 border-t"><span class="text-gray-800 font-semibold">Total:</span><span class="text-blue-600 font-bold">~2,268 PLN</span></div></div></div>
            <div class="border-b pb-4"><h3 class="text-lg font-semibold text-gray-800 mb-2">Tolls & Vignettes</h3><div class="space-y-2"><div class="flex justify-between"><span class="text-gray-600">Austria vignettes:</span><span class="font-medium">10-day €12.40 + 1-day €9.30</span></div><div class="flex justify-between"><span class="text-gray-600">Italian highways:</span><span class="font-medium">~€140-€180</span></div><div class="flex justify-between pt-2 border-t"><span class="text-gray-800 font-semibold">Total:</span><span class="text-blue-600 font-bold">~€162-€202</span></div></div></div>
            <div class="border-b pb-4"><h3 class="text-lg font-semibold text-gray-800 mb-2">Parking</h3><div class="space-y-2"><div class="flex justify-between"><span class="text-gray-600">City parking:</span><span class="font-medium">~€150-€200 total</span></div><div class="flex justify-between"><span class="text-gray-600">Venice parking:</span><span class="font-medium">~€29-€58</span></div></div></div>
            <div class="border-b pb-4"><h3 class="text-lg font-semibold text-gray-800 mb-2">Public Transport</h3><div class="space-y-2"><div class="flex justify-between"><span class="text-gray-600">Venice 24h ACTV ticket:</span><span class="font-medium">~€25/person</span></div><div class="flex justify-between"><span class="text-gray-600">For 4 people:</span><span class="font-medium">~€100</span></div></div></div>
          </div>
          <div class="mt-8 bg-blue-50 p-4 rounded-lg">
            <h3 class="text-lg font-semibold text-gray-800 mb-2">Total Estimated Costs</h3>
            <div class="flex justify-between items-center"><div><p class="text-gray-600">This includes fuel, tolls, parking, and public transport.</p><p class="text-sm text-gray-500 mt-1">Accommodation, food, and attractions not included.</p></div><div class="text-2xl font-bold text-blue-600">~3,000-3,500 PLN</div></div>
          </div>
        </div>
      </div>
      <div class="mt-8 text-center">
        <button id="downloadPdf" class="inline-flex items-center gap-2 bg-white text-blue-600 border border-blue-200 hover:bg-blue-50 px-5 py-3 rounded-lg font-medium"><i class="fas fa-file-pdf"></i> Download simplified PDF itinerary</button>
      </div>
    </div>
  </section>

  <!-- Tips -->
  <section id="tips" class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-gray-800">Travel Tips</h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="bg-gray-50 p-6 rounded-xl shadow-sm hover:shadow-md transition"><div class="text-blue-500 text-3xl mb-4"><i class="fas fa-ticket-alt"></i></div><h3 class="text-xl font-semibold mb-2 text-gray-800">Book Attractions Early</h3><p class="text-gray-600">Reserve tickets for Uffizi and Accademia galleries in Florence well in advance to avoid long queues.</p></div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-sm hover:shadow-md transition"><div class="text-blue-500 text-3xl mb-4"><i class="fas fa-ship"></i></div><h3 class="text-xl font-semibold mb-2 text-gray-800">Boat Schedules</h3><p class="text-gray-600">Check Lake Garda boat schedules the day before to plan your trips around the lake effectively.</p></div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-sm hover:shadow-md transition"><div class="text-blue-500 text-3xl mb-4"><i class="fas fa-car"></i></div><h3 class="text-xl font-semibold mb-2 text-gray-800">ZTL Zones</h3><p class="text-gray-600">Be careful with Limited Traffic Zones (ZTL) in Florence and Pisa - unauthorized entry results in fines.</p></div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-sm hover:shadow-md transition"><div class="text-blue-500 text-3xl mb-4"><i class="fas fa-money-bill-wave"></i></div><h3 class="text-xl font-semibold mb-2 text-gray-800">Cash for Small Payments</h3><p class="text-gray-600">Have cash ready for small highway tolls and parking payments where cards might not be accepted.</p></div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-sm hover:shadow-md transition"><div class="text-blue-500 text-3xl mb-4"><i class="fas fa-venice"></i></div><h3 class="text-xl font-semibold mb-2 text-gray-800">Venice Access</h3><p class="text-gray-600">No entrance fee for Venice in September 2025. Consider staying in Mestre for cheaper accommodation.</p></div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-sm hover:shadow-md transition"><div class="text-blue-500 text-3xl mb-4"><i class="fas fa-passport"></i></div><h3 class="text-xl font-semibold mb-2 text-gray-800">Documents</h3><p class="text-gray-600">Ensure all drivers have valid licenses, vehicle documents, and insurance for international travel.</p></div>
      </div>
    </div>
  </section>

  <!-- Comments (Giscus) -->
  <section id="comments" class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-bold text-center mb-6 text-gray-800">Guestbook & Comments</h2>
      <p class="text-center text-gray-500 mb-8">Powered by <a class="underline" href="https://giscus.app" target="_blank" rel="noopener">Giscus</a> (GitHub Discussions). Comments sync across devices.</p>
      <div class="max-w-3xl mx-auto">
        <script src="https://giscus.app/client.js"
                data-repo="LesiuPS/ItalianTrip"
                data-repo-id="R_kgDOPbuJbg"
                data-category="General"
                data-category-id="DIC_kwDOPbuJbs4CuEZA"
                data-mapping="pathname"
                data-strict="0"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="light"
                data-lang="en"
                crossorigin="anonymous"
                async>
        </script>
      </div>
    </div>
  </section>

  <!-- Countdown -->
  <section class="py-16 bg-blue-600 text-white">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-3xl md:text-4xl font-bold mb-6">Counting Down to Adventure</h2>
      <div class="flex justify-center space-x-4 md:space-x-8" id="countdown">
        <div class="bg-white text-blue-600 rounded-lg p-4 w-20 md:w-24"><div class="text-2xl md:text-3xl font-bold" id="days">--</div><div class="text-sm">Days</div></div>
        <div class="bg-white text-blue-600 rounded-lg p-4 w-20 md:w-24"><div class="text-2xl md:text-3xl font-bold" id="hours">--</div><div class="text-sm">Hours</div></div>
        <div class="bg-white text-blue-600 rounded-lg p-4 w-20 md:w-24"><div class="text-2xl md:text-3xl font-bold" id="minutes">--</div><div class="text-sm">Minutes</div></div>
        <div class="bg-white text-blue-600 rounded-lg p-4 w-20 md:w-24"><div class="text-2xl md:text-3xl font-bold" id="seconds">--</div><div class="text-sm">Seconds</div></div>
      </div>
      <p class="mt-8 text-blue-100">We're excited for our journey from Bydgoszcz through Vienna to the beautiful Italian lakes and cities!</p>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-8">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0"><div class="flex items-center space-x-2"><i class="fas fa-route text-2xl text-blue-400"></i><span class="text-xl font-bold">Road Trip 2025</span></div><p class="text-gray-400 mt-2">Bydgoszcz to Italy • 11-21 September 2025</p></div>
        <div class="flex space-x-6"><a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-facebook-f text-xl"></i></a><a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-instagram text-xl"></i></a><a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-twitter text-xl"></i></a></div>
      </div>
      <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400"><p>Created with ❤️ for our unforgettable road trip adventure</p><p class="mt-2 text-sm">© 2025 Road Trip Crew. All rights reserved.</p></div>
    </div>
  </footer>

  <!-- Lightweight alerts -->
  <div id="appAlerts" class="hidden fixed top-4 left-1/2 -translate-x-1/2 z-[100]">
    <div class="bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg text-sm" id="appAlertsMsg"></div>
  </div>

  <script>
    // ===== Mobile menu toggle =====
    const menuBtn = document.getElementById('menuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    menuBtn.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));

    // ===== Smooth scrolling =====
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
        mobileMenu.classList.add('hidden');
      });
    });

    // ===== Countdown timer =====
    function updateCountdown() {
      const tripDate = new Date('September 11, 2025 00:00:00').getTime();
      const now = new Date().getTime();
      const distance = Math.max(tripDate - now, 0);
      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);
      document.getElementById('days').textContent = days;
      document.getElementById('hours').textContent = hours;
      document.getElementById('minutes').textContent = minutes;
      document.getElementById('seconds').textContent = seconds;
    }
    updateCountdown();
    setInterval(updateCountdown, 1000);

    // ===== MAP + ITINERARY SYNC =====
    const WAYPOINTS = [
      { day: 1, title: 'Bydgoszcz → Vienna', city: 'Vienna',        lat: 48.2082, lng: 16.3738,   note: 'Arrival and evening walk' },
      { day: 2, title: 'Vienna Exploration → Klagenfurt/Villach',   city: 'Klagenfurt',   lat: 46.6247, lng: 14.3053, note: 'Overnight near A2' },
      { day: 3, title: 'Klagenfurt → Lake Garda',                   city: 'Desenzano del Garda', lat: 45.4712, lng: 10.5354, note: 'Evening by the lake' },
      { day: 4, title: 'Lake Garda Day',                            city: 'Garda / Monte Baldo', lat: 45.5630, lng: 10.7150, note: 'Boat + Monte Baldo' },
      { day: 5, title: 'Lake Garda → Florence',                     city: 'Florence',     lat: 43.7696, lng: 11.2558, note: 'Tuscan evening' },
      { day: 6, title: 'Florence Exploration',                      city: 'Florence',     lat: 43.7731, lng: 11.2556, note: 'Uffizi, Duomo, Ponte Vecchio' },
      { day: 7, title: 'Pisa Excursion',                            city: 'Pisa',         lat: 43.7230, lng: 10.3966, note: 'Leaning Tower' },
      { day: 8, title: 'Florence → Venice',                         city: 'Venice',       lat: 45.4408, lng: 12.3155, note: 'Check-in Mestre/Tronchetto' },
      { day: 9, title: 'Venice Day',                                city: 'Venice',       lat: 45.4386, lng: 12.3275, note: 'San Marco & Rialto' },
      { day:10, title: 'Venice → Austria (Vienna area)',            city: 'Austria (A2)', lat: 47.5000, lng: 16.0000, note: 'Return drive break' },
      { day:11, title: 'Austria → Bydgoszcz',                       city: 'Bydgoszcz',    lat: 53.1235, lng: 18.0084, note: 'Home' }
    ];

    let map, markers = [], routeLine;
    function initMap() {
      map = L.map('map', { zoomSnap: 0.25, scrollWheelZoom: true });
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '&copy; OSM contributors' }).addTo(map);

      WAYPOINTS.forEach((wp) => {
        const isStop = ![1,5,8,11].includes(wp.day) ? 'marker-stop' : 'marker-day';
        const icon = L.divIcon({ className: 'leaflet-div-icon', html: `<div class="marker-dot ${isStop}">${wp.day}</div>`, iconSize: [30,30], iconAnchor: [15,15] });
        const m = L.marker([wp.lat, wp.lng], { icon }).addTo(map);
        m.bindPopup(`<strong>Day ${wp.day}</strong><br>${wp.title}<br><em>${wp.city}</em><br>${wp.note}`);
        m._day = wp.day; markers.push(m);
      });

      const latlngs = WAYPOINTS.map(w => [w.lat, w.lng]);
      routeLine = L.polyline(latlngs, { weight: 5, opacity: 0.7 }).addTo(map);
      map.fitBounds(routeLine.getBounds(), { padding: [20,20] });

      const km = (function(){ let d=0; for(let i=1;i<latlngs.length;i++){ d += haversine(latlngs[i-1], latlngs[i]); } return Math.round(d); })();
      const info = L.control({ position: 'bottomleft' });
      info.onAdd = function(){ const div = L.DomUtil.create('div', 'bg-white/90 rounded-lg shadow p-2 text-sm'); div.innerHTML = `<i class="fas fa-road mr-1 text-blue-600"></i>Approx route length: <strong>${km} km</strong>`; return div; };
      info.addTo(map);

      bindTimelineInteractions();
    }

    function haversine(a, b) {
      const toRad = x => x * Math.PI / 180; const [lat1, lon1] = a; const [lat2, lon2] = b; const R = 6371;
      const dLat = toRad(lat2-lat1), dLon = toRad(lon2-lon1);
      const s1 = Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
      return 2 * R * Math.asin(Math.sqrt(s1));
    }

    function bindTimelineInteractions(){
      const items = document.querySelectorAll('.trip-day');
      items.forEach((el, idx) => {
        const day = Number(el.dataset.day || (idx+1));
        el.dataset.day = String(day);
        el.addEventListener('mouseenter', () => focusDay(day, { openPopup: false }));
        el.addEventListener('mouseleave', () => routeLine.setStyle({ weight: 5, opacity: 0.7 }));
        el.addEventListener('click', () => focusDay(day, { openPopup: true, smooth: true }));
      });
    }

    function focusDay(day, opts={}){
      const m = markers.find(mm => mm._day === day);
      if(!m) return;
      routeLine.setStyle({ weight: 6.5, opacity: 0.95 });
      const latlng = m.getLatLng();
      map.panTo(latlng, { animate: true });
      if(opts.openPopup) { m.openPopup(); }
      document.querySelectorAll('.trip-day').forEach(el => el.classList.remove('ring-2','ring-blue-400'));
      const el = document.querySelector(`.trip-day[data-day="${day}"]`);
      if(el) el.classList.add('ring-2','ring-blue-400');
    }

    // Show more days
    const showMoreBtn = document.getElementById('showMoreDays');
    const extra = document.getElementById('extraDays');
    showMoreBtn.addEventListener('click', () => {
      extra.classList.toggle('timeline-hidden');
      showMoreBtn.textContent = extra.classList.contains('timeline-hidden') ? 'Show Full Itinerary' : 'Hide Full Itinerary';
      bindTimelineInteractions();
      ensureGalleries();
    });

    // ===== MINI MAP =====
    let miniMap, miniRoute, miniMarkerRefs = [];
    function initMiniMap(){
      miniMap = L.map('miniMap', { zoomControl:false, attributionControl:false, dragging:true, scrollWheelZoom:false });
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(miniMap);
      const latlngs = WAYPOINTS.map(w => [w.lat, w.lng]);
      miniRoute = L.polyline(latlngs, { weight: 3, opacity: 0.7 }).addTo(miniMap);
      miniMap.fitBounds(miniRoute.getBounds(), { padding: [10,10] });
      WAYPOINTS.forEach((wp)=>{
        const icon = L.divIcon({ className:'leaflet-div-icon', html:`<div class='marker-dot marker-day' style='transform:scale(.7)'>${wp.day}</div>`, iconSize:[22,22], iconAnchor:[11,11] });
        const m = L.marker([wp.lat, wp.lng], { icon }).addTo(miniMap); miniMarkerRefs.push(m);
      });
      const origFocus = focusDay;
      window.focusDay = function(day, opts){ origFocus(day, opts); const m = miniMarkerRefs[day-1]; if(m) miniMap.panTo(m.getLatLng(), { animate:true }); };
    }

    // ===== DAY GALLERIES =====
    const DAY_PHOTOS = {
      1: ['https://images.unsplash.com/photo-1543357480-c60d40007a8d?auto=format&fit=crop&w=800&q=60','https://images.unsplash.com/photo-1555169062-013468b47731?auto=format&fit=crop&w=800&q=60'],
      3: ['https://images.unsplash.com/photo-1533105079780-92b9be482077?auto=format&fit=crop&w=800&q=60','https://images.unsplash.com/photo-1504196606672-aef5c9cefc92?auto=format&fit=crop&w=800&q=60'],
      4: ['https://images.unsplash.com/photo-1509023464722-18d996393ca8?auto=format&fit=crop&w=800&q=60','https://images.unsplash.com/photo-1464790719320-516ecd75af6c?auto=format&fit=crop&w=800&q=60'],
      5: ['https://images.unsplash.com/photo-1543348750-466b55f32f34?auto=format&fit=crop&w=800&q=60','https://images.unsplash.com/photo-1526129318478-62ed807ebdf9?auto=format&fit=crop&w=800&q=60'],
      8: ['https://images.unsplash.com/photo-1467269204594-9661b134dd2b?auto=format&fit=crop&w=800&q=60','https://images.unsplash.com/photo-1528909514045-2fa4ac7a08ba?auto=format&fit=crop&w=800&q=60'],
      9: ['https://images.unsplash.com/photo-1512453979798-5ea266f8880c?auto=format&fit=crop&w=800&q=60','https://images.unsplash.com/photo-1545134969-8debd725b007?auto=format&fit=crop&w=800&q=60']
    };

    function ensureGalleries(){
      document.querySelectorAll('.trip-day').forEach(dayEl => {
        const day = Number(dayEl.dataset.day);
        if(!DAY_PHOTOS[day]) return;
        if(dayEl.querySelector('.photo-strip')) return;
        const container = document.createElement('div'); container.className = 'photo-strip';
        DAY_PHOTOS[day].forEach(url => { const img = document.createElement('img'); img.loading='lazy'; img.src=url; img.alt='Photo'; container.appendChild(img); });
        const card = dayEl.querySelector('.bg-white');
        const toggler = document.createElement('button');
        toggler.className = 'mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium';
        toggler.innerHTML = '<i class="fas fa-images mr-1"></i> Show photos';
        let visible = false;
        toggler.addEventListener('click', () => { visible = !visible; toggler.textContent = visible ? 'Hide photos' : 'Show photos'; container.style.display = visible ? 'flex' : 'none'; });
        container.style.display = 'none'; card.appendChild(toggler); card.appendChild(container);

        // Weather button for quick access
        const header = card.querySelector('.flex.justify-between');
        if(header && !card.querySelector('.weather-btn')){
          const btn = document.createElement('button');
          btn.className = 'weather-btn ml-2 inline-flex items-center text-xs px-2 py-1 rounded bg-blue-50 text-blue-700 hover:bg-blue-100';
          btn.innerHTML = '<i class="fas fa-cloud-sun mr-1"></i> Weather';
          btn.addEventListener('click', (e)=>{ e.stopPropagation(); focusDay(day, { openPopup:false }); });
          header.appendChild(btn);
        }
      });
    }
    ensureGalleries();

    // ===== WEATHER (Open‑Meteo) =====
    const weatherBox = document.getElementById('weatherBox');
    const weatherTitle = document.getElementById('weatherTitle');
    const weatherContent = document.getElementById('weatherContent');
    document.getElementById('closeWeather').addEventListener('click', ()=> weatherBox.classList.add('hidden'));

    async function fetchWeatherForDay(day){
      const wp = WAYPOINTS.find(w=>w.day===day); if(!wp) return;
      weatherTitle.textContent = `Weather • ${wp.city}`;
      weatherContent.innerHTML = '<div class="py-4 text-center">Loading forecast…</div>';
      weatherBox.classList.remove('hidden');
      try{
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${wp.lat}&longitude=${wp.lng}&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=auto`;
        const res = await fetch(url);
        const data = await res.json();
        const days = data.daily.time.map((d,i)=>({ date: d, tmax: Math.round(data.daily.temperature_2m_max[i]), tmin: Math.round(data.daily.temperature_2m_min[i]), code: data.daily.weathercode[i] })).slice(0,7);
        const rows = days.map(x=>`<div class='flex justify-between py-1 border-b last:border-b-0'><span>${x.date}</span><span class='font-medium'>${x.tmin}° / ${x.tmax}°C</span></div>`).join('');
        weatherContent.innerHTML = `<div class='text-xs text-gray-500 mb-1'>7‑day forecast (from today)</div>${rows}`;
      }catch(e){ weatherContent.textContent = 'Could not load weather right now.'; }
    }

    const _origFocusDay = focusDay;
    focusDay = function(day, opts){ _origFocusDay(day, opts); fetchWeatherForDay(day); };

    // ===== PDF EXPORT =====
    document.getElementById('downloadPdf').addEventListener('click', async ()=>{
      if (!window.jspdf) { await loadScript('https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js'); }
      if (!window.jspdf) { return alertUser('PDF module failed to load. Are external CDNs blocked?'); }
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: 'pt', format: 'a4' });
      const margin = 40; let y = margin;
      doc.setFont('helvetica','bold'); doc.setFontSize(18);
      doc.text('Road Trip 2025 – Bydgoszcz → Italy', margin, y); y += 26;
      doc.setFont('helvetica',''); doc.setFontSize(12);
      doc.text('Dates: 11–21 September 2025', margin, y); y += 10;
      doc.text('Route: Bydgoszcz → Vienna → Lake Garda → Florence → Pisa → Venice → Bydgoszcz', margin, y); y += 20;
      WAYPOINTS.forEach(wp => { if(y > 780){ doc.addPage(); y = margin; } doc.setFont('helvetica','bold'); doc.text(`Day ${wp.day}: ${wp.title}`, margin, y); y += 14; doc.setFont('helvetica',''); doc.text(`Stop: ${wp.city} — ${wp.note}`, margin, y); y += 18; });
      doc.save('RoadTrip2025-Itinerary.pdf');
    });

    // ===== Initialize on load with fallbacks =====
    window.addEventListener('load', async () => {
      if (typeof window.L === 'undefined') {
        await loadScript('https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js');
        const css = document.createElement('link'); css.rel='stylesheet'; css.href='https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css'; document.head.appendChild(css);
      }
      try { initMap(); initMiniMap(); } catch (e) { alertUser('Map failed to load. Try refreshing, or check your network/CSP.'); }
      try { ensureGalleries(); } catch(e) { console.warn(e); }
    });

    // ===== Utilities =====
    function loadScript(src){
      return new Promise((resolve, reject)=>{ const s = document.createElement('script'); s.src = src; s.async = true; s.onload = ()=> resolve(); s.onerror = ()=> reject(new Error('Failed to load '+src)); document.head.appendChild(s); });
    }
    function alertUser(msg){ const box = document.getElementById('appAlerts'); const msgEl = document.getElementById('appAlertsMsg'); if(!box || !msgEl){ alert(msg); return; } msgEl.textContent = msg; box.classList.remove('hidden'); setTimeout(()=> box.classList.add('hidden'), 4000); }
  </script>
</body>
</html>
